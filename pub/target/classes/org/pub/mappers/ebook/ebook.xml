<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="eBook">
<!-- 주석달려있는게 8월 19일자로 추가된것 -->
<insert id="upload">
insert into ebook (e_no,e_title,e_author,e_publisher,e_publication_year,e_introduce,e_group) values(e_num_seq.nextval,#{e_title},#{e_author},#{e_publisher},#{e_publication_year},#{e_introduce},#{e_group})
</insert>
<select id="sel" resultType="ebook">
select * from ebook order by e_no desc
</select>
<select id="sel_one" resultType="ebook">
select * from ebook where e_no=#{no}
</select>
<update id="up_recommend">
update ebook set e_recommend=e_recommend+1 where e_no=#{i}
</update>
<insert id="addBook"><!-- 전자책등록 -->
insert into ebook (e_no,e_title,e_author,e_publisher,e_publication_year,e_introduce,e_group) values(e_no_seq.nextval,#{e_title},#{e_author},#{e_publisher},#{e_publication_year},#{e_introduce},#{e_group})
</insert>
<select id="getBook_no" resultType="int"><!-- 전자책 번호 가져오는것 -->
select e_no from ebook where e_title=#{e_title} and e_author=#{e_author} and e_publisher=#{e_publisher} and e_publication_year=#{e_publication_year} and e_group=#{e_group}
</select>
<select id="getEbook" resultType="ebook"><!-- 전자책 정보 가져오기 -->
select * from ebook where e_no=#{e_no}
</select>
<insert id="recommand" parameterType="java.util.Map"><!-- 추천 했는지 확인하기위한 테이블 -->
insert into recommand values(#{id},#{e_no})
</insert>
<update id="e_recommand_up" parameterType="java.util.Map"><!-- 해당 번호의 전자책 추천 횟수 증가 -->
update ebook set e_recommend=e_recommend+1 where e_no=#{e_no}
</update>
<select id="getrecommand" parameterType="java.util.Map" resultType="String"><!-- 추천 확인을 위한 값을 받아옴. -->
select * from recommand where id=#{id} and e_no=#{e_no}
</select>
<delete id="non_recommand">
delete from recommand where id=#{id} and e_no=#{e_no}
</delete>
<update id="e_recommand_down" parameterType="java.util.Map"><!-- 해당 번호의 전자책 추천 횟수 감소 -->
update ebook set e_recommend=e_recommend-1 where e_no=#{e_no}
</update>
</mapper>